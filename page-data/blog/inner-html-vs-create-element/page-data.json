{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/blog/inner-html-vs-create-element/","result":{"data":{"markdownRemark":{"html":"<h2><strong>innerHTML vs createElement 속도 벤치마킹 해보기</strong></h2>\n<p class=\"text-time\">최초 업로드 2024-02-12 / 마지막 수정 2024-02-25</p>\n<p>innerHTML vs createElement 속도 비교가 궁금해서 테스팅해보았다.</p>\n<ul>\n<li>단 하나의 createElement는 단 한 줄의 innerHTML 보다 빠르다.</li>\n<li>4~5개의 createElement는 4~5줄의 innerHTML과 속도가 비슷하다.</li>\n<li>100줄의 createElement는 100줄의 innerHTML 보다 훨씬 느리다.</li>\n</ul>\n<p>결론:</p>\n<ul>\n<li><span class=\"text-orange\">속도 면에서는 innerHTML이 절대 뒤지는 편이 아니다.</span></li>\n<li>innerHTML을 한줄씩 계속 파싱하면 조금 느리긴하다.</li>\n<li>대량의 html 스트링을 한 번에 파싱할 때에는 createElement 보다 innerHTML이 월등히 좋다.</li>\n<li><span class=\"text-skyblue\">결국 속도 보다는 사용처가 중요해보인다. 컨트롤이 필요할 때는 createElement, 구조에 대해 가독성이 필요할 때는 innerHTML이 좋아보인다.</span></li>\n</ul>\n<br/>\n<h2><strong>시각화</strong></h2>\n<img src=\"https://d1ykeqyorqdego.cloudfront.net/new-assets/innerHTML-speed.png\" style=\"width: 100%;\">\n<br/>\n<p><code class=\"language-text\">create100</code>과 <code class=\"language-text\">parse100</code>이 확연한 차이를 보이는 것이 가장 흥미로운 점이었다. 100개의 <code class=\"language-text\">createElement</code> 보다 100줄의 <code class=\"language-text\">innerHTML</code>이 평균적으로 훨씬 빨랐다.</p>\n<p>그리고 각종 스택 오버플로우 글들을 읽어본 결과 브라우저 JS 엔진이 실행 도중에 optimization을 해서 회차별로 시간이 빨라질 수 있다는 것이었다. 내 코드는 매우 단순해서\n그런 최적화가 많이 돌지도 의문이지만 일단 x축 회차 간의 시간적 independence(시간적 데이터 독립성)는 보장되지 않는다. 서로 얽혀있을 수 있다는 뜻이다.</p>\n<p>아쉬운 것은 아래 섹션 <code class=\"language-text\">코드를 만든 과정</code>에서 나온 것처럼\n서브 밀리세컨드 데이터는 브라우저가 보안상 측정을 막아두어서 정확한 편차를 보기가 어렵다는 것이다. 이를 볼 수 있으면 더 세밀하게 데이터를 관찰할 수 있었을 것이다.</p>\n<br/>\n<h2><strong>코드를 만든 과정</strong></h2>\n<p>원래 Benchmark.js를 사용하다가 개별 테스트를 가져올 수 없어서 커스텀으로 브라우저에서 제공하는 <code class=\"language-text\">performance.now</code>를 사용해서 만들었는데\n알고보니 개별 테스트는 브라우저로부터 가져올 수 없는 데이터였다. 이유는 아래에 나와있다.</p>\n<p>지금 현재 6개의 테스트를 1000번씩 100회 반복한다. 그렇기에 꽤 오래걸리는 편이다.\n테스트 횟수를 한 번에 1000번씩 하는 이유는 존재한다. 크롬 브라우저는 보안 문제 때문에\n코드 <code class=\"language-text\">performance.now()</code>로 시간 측정하는 것의 정확도를 0.1ms로 제한한다고 한다. 그래서\n한 번에 테스팅할 코드가 짧고 빠른 코드면 횟수를 많이 늘려서 <a href=\"https://stackoverflow.com/questions/52069915/accurately-measure-a-javascript-function-performance-while-displaying-the-output\">평균을 가져올 수 밖에 없다</a>고 한다.\nBenchmark.js는 어떻게 +- 편차를 가져오는지 잘 모르겠다. 심지어 55회만 반복하고 꽤나 정확한? 수치를 가져왔다고 생각했는데\n아닐 수도 있겠다.</p>\n<p><code class=\"language-text\">Benchmark.js</code> 내부 소스는 <a href=\"https://github.com/bestiejs/benchmark.js/blob/main/benchmark.js\">단 한 개의 파일</a>로 이루어져있다.\n이 파일을 잘 살펴보면 아래와 같이 크롬 내부 무언가를 가져오는데 이것이 <code class=\"language-text\">performance.now()</code>인지 잘 모르겠다. 오늘은 탐구심 도파민이 소진되어서\n더 깊게 들어가긴 피로하다. 다음 번에 흥미를 얻으면 다시 파보자.</p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Detect Chrome's microsecond timer:</span>\n<span class=\"token comment\">// enable benchmarking via the --enable-benchmarking command</span>\n<span class=\"token comment\">// line switch in at least Chrome 7 to use chrome.Interval</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">.</span>ns <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>chrome <span class=\"token operator\">||</span> context<span class=\"token punctuation\">.</span>chromium<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Interval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    timers<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">ns</span><span class=\"token operator\">:</span> timer<span class=\"token punctuation\">.</span>ns<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> <span class=\"token function\">getRes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"us\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">unit</span><span class=\"token operator\">:</span> <span class=\"token string\">\"us\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h2><strong>코드 간략 설명</strong></h2>\n<p>6개의 테스트를 1000번씩 100회 반복 한다. 3분 이상 걸린다.\n1000번은 나눌 수 없는 단위로 되어있다. 100번으로 줄일 수는 있다. 이유는 위에 설명되어있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">create5Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> temp <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        temp<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n        children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">parse5Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        str <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>hello&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> str<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">create100Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> temp <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        temp<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n        children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">parse100Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        str <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>hello&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> str<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">createEvent100Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> temp <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        temp<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">;</span>\n        temp<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>temp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">parseEvent100Children</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"div\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">let</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        str <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>hello&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      div<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> str<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        div<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">measureExecutionTime</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">testFunction</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> div <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n      <span class=\"token keyword\">const</span> start <span class=\"token operator\">=</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> div<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">testFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">const</span> end <span class=\"token operator\">=</span> performance<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>end <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> div<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">testName<span class=\"token punctuation\">,</span> testFunction<span class=\"token punctuation\">,</span> iterations <span class=\"token operator\">=</span> <span class=\"token number\">100</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> results <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> iterations<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> timeTaken <span class=\"token operator\">=</span> <span class=\"token function\">measureExecutionTime</span><span class=\"token punctuation\">(</span>testFunction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        results<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> testName<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">iteration</span><span class=\"token operator\">:</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> timeTaken <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> results<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">runAllTests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> allResults <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create5\"</span><span class=\"token punctuation\">,</span> create5Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create100\"</span><span class=\"token punctuation\">,</span> create100Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create100wEvents\"</span><span class=\"token punctuation\">,</span> createEvent100Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parse5\"</span><span class=\"token punctuation\">,</span> parse5Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parse100\"</span><span class=\"token punctuation\">,</span> parse100Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token operator\">...</span><span class=\"token function\">runTest</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"parse100wEvent\"</span><span class=\"token punctuation\">,</span> parseEvent100Children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">exportResultsToCSV</span><span class=\"token punctuation\">(</span>allResults<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">function</span> <span class=\"token function\">exportResultsToCSV</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> csvContent <span class=\"token operator\">=</span> <span class=\"token string\">\"data:text/csv;charset=utf-8,Test Name,Iteration,Time Taken (ms)\\n\"</span><span class=\"token punctuation\">;</span>\n      data<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> testName<span class=\"token punctuation\">,</span> iteration<span class=\"token punctuation\">,</span> timeTaken <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        csvContent <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>testName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>iteration<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>timeTaken<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">var</span> encodedUri <span class=\"token operator\">=</span> <span class=\"token function\">encodeURI</span><span class=\"token punctuation\">(</span>csvContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">var</span> link <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      link<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"href\"</span><span class=\"token punctuation\">,</span> encodedUri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      link<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"download\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"detailed_benchmark_results.csv\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>link<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      link<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">runAllTests</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span></code></pre></div>\n<br/>\n<h2><strong>시각화 코드</strong></h2>\n<p>아래 코드는 콜랩에서 실행하고 이미지로 다운로드 받았다. 원래는 plotly로 embed하려고 했는데 gatsby에서 iframe을 직접적으로 지원하지 않는다는 사실을 깨닫고\n이미지로 서빙했다. 조금 충격이었다. 컴포넌트를 만들어서 다시 markdown에 넣는 식으로 해야되는데 그것까지 하기에는 시간이 부족하다.\ncsv코드는 위의 js 코드에서 추출해서 가져올 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> plotly<span class=\"token punctuation\">.</span>express <span class=\"token keyword\">as</span> px\n\n<span class=\"token comment\"># Read the CSV file into a pandas DataFrame</span>\nfile_path <span class=\"token operator\">=</span> <span class=\"token string\">'/detailed_benchmark_results.csv'</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Generate a line plot with Plotly Express, now with a template for a prettier look</span>\nfig <span class=\"token operator\">=</span> px<span class=\"token punctuation\">.</span>line<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span><span class=\"token string\">'Iteration'</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span><span class=\"token string\">'Time Taken (ms)'</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">'Test Name'</span><span class=\"token punctuation\">,</span>\n              title<span class=\"token operator\">=</span><span class=\"token string\">'회차 별 소요 시간'</span><span class=\"token punctuation\">,</span>\n              template<span class=\"token operator\">=</span><span class=\"token string\">'plotly_white'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Using a light theme for a cleaner look</span>\n\n<span class=\"token comment\"># Customize the layout further for a prettier look</span>\nfig<span class=\"token punctuation\">.</span>update_layout<span class=\"token punctuation\">(</span>\n    xaxis_title<span class=\"token operator\">=</span><span class=\"token string\">'회차'</span><span class=\"token punctuation\">,</span>\n    yaxis_title<span class=\"token operator\">=</span><span class=\"token string\">'소요 시간 (ms)'</span><span class=\"token punctuation\">,</span>\n    legend_title<span class=\"token operator\">=</span><span class=\"token string\">'테스트 이름'</span><span class=\"token punctuation\">,</span>\n    plot_bgcolor<span class=\"token operator\">=</span><span class=\"token string\">'rgba(0,0,0,0)'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># Transparent background for the plot area</span>\n    xaxis<span class=\"token operator\">=</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>\n        showline<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n        showgrid<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n        gridcolor<span class=\"token operator\">=</span><span class=\"token string\">'lightgray'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># Lighter gridlines</span>\n        linewidth<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        linecolor<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># Darker axis line</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    yaxis<span class=\"token operator\">=</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>\n        showline<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n        showgrid<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n        gridcolor<span class=\"token operator\">=</span><span class=\"token string\">'lightgray'</span><span class=\"token punctuation\">,</span>\n        linewidth<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        linecolor<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    font<span class=\"token operator\">=</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>  <span class=\"token comment\"># Customizing font</span>\n        family<span class=\"token operator\">=</span><span class=\"token string\">\"Arial, sans-serif\"</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># A commonly used font family</span>\n        size<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span>\n        color<span class=\"token operator\">=</span><span class=\"token string\">\"RebeccaPurple\"</span>  <span class=\"token comment\"># A pleasant shade of purple</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    legend<span class=\"token operator\">=</span><span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>\n        bgcolor<span class=\"token operator\">=</span><span class=\"token string\">'rgba(255,255,255,0.5)'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># Semi-transparent legend background</span>\n        bordercolor<span class=\"token operator\">=</span><span class=\"token string\">'Black'</span><span class=\"token punctuation\">,</span>\n        borderwidth<span class=\"token operator\">=</span><span class=\"token number\">1</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Show the figure</span>\nfig<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nfig<span class=\"token punctuation\">.</span>write_html<span class=\"token punctuation\">(</span><span class=\"token string\">'/plot.html'</span><span class=\"token punctuation\">)</span>\n</code></pre></div>","frontmatter":{"date":"February 12, 2024","slug":"/blog/inner-html-vs-create-element","title":"innerHTML vs createElement 속도","subtitle":"JS 코드의 속도를 비교 테스팅해보자 - innerHTML vs createElement"}}},"pageContext":{"id":"c6d38180-40fd-5b50-937c-79299b60f071","frontmatter__slug":"/blog/inner-html-vs-create-element","__params":{"frontmatter__slug":"blog"}}},"staticQueryHashes":["1865044719","2228436175","326441978"],"slicesMap":{}}